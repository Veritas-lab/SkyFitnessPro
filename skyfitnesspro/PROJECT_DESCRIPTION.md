# SkyFitnessPro - Описание проекта

## Общая информация

**SkyFitnessPro** — это веб-приложение для онлайн-тренировок, разработанное на основе Next.js. Приложение предоставляет пользователям возможность просматривать различные фитнес-курсы, добавлять их в свой профиль, отслеживать прогресс тренировок и выполнять упражнения с видео-материалами.

## Технологический стек

### Frontend
- **Next.js 16.1.2** (App Router) — React-фреймворк для продакшн-готовых приложений
- **React 19.2.3** — библиотека для построения пользовательских интерфейсов
- **TypeScript 5** — типизированный JavaScript для повышения надежности кода
- **Tailwind CSS 4.1.18** — utility-first CSS фреймворк для стилизации
- **CSS Modules** — модульные стили для компонентов

### State Management
- **Redux Toolkit 2.11.2** — инструментарий для управления глобальным состоянием
- **React Redux 9.2.0** — связующая библиотека для React и Redux

### Формы и валидация
- **React Hook Form 7.71.1** — библиотека для управления формами
- **Zod 4.3.5** — схема валидации TypeScript-first
- **@hookform/resolvers 3.9.1** — резолверы для интеграции Zod с React Hook Form

### HTTP-клиенты
- **Axios 1.13.2** — HTTP-клиент для API запросов

### Дополнительные библиотеки
- **react-player 3.4.0** — компонент для воспроизведения видео (YouTube)
- **SWR 2.3.8** — библиотека для получения данных (опционально)

### Инструменты разработки
- **ESLint** — линтер для проверки кода
- **Prettier** — форматтер кода
- **PostCSS** — инструмент для обработки CSS

## Архитектура приложения

### Структура проекта

```
skyfitnesspro/
├── app/                          # Next.js App Router
│   ├── api/                      # API Routes (Next.js серверные роуты)
│   │   ├── auth/                 # Роуты авторизации
│   │   ├── courses/              # Роуты для работы с курсами
│   │   ├── fitness/              # Прокси-роут для внешнего API
│   │   ├── progress/             # Роуты для прогресса
│   │   ├── users/                # Роуты для пользователей
│   │   └── workouts/             # Роуты для тренировок
│   ├── auth/                     # Страницы авторизации
│   ├── courses/                  # Страницы курсов
│   │   └── [courses_id]/
│   │       └── workouts/
│   │           └── [workouts_id]/ # Страница конкретной тренировки
│   ├── users/me/courses/         # Страница профиля пользователя
│   ├── layout.tsx                # Корневой layout
│   ├── page.tsx                  # Главная страница
│   └── Providers.tsx             # Провайдеры (Redux, Context)
├── components/                   # React компоненты
│   ├── AuthButtons/              # Кнопки авторизации
│   ├── Button/                   # Переиспользуемая кнопка
│   ├── CourseCard/               # Карточка курса
│   ├── CoursesBlock/             # Блок с курсами
│   ├── Form.tsx                  # Форма авторизации/регистрации
│   ├── Header/                   # Шапка сайта
│   ├── Logo/                     # Логотип приложения
│   ├── ModalLogin/               # Модальное окно авторизации
│   ├── ModalProgress/            # Модальное окно прогресса
│   ├── ModalUser/                # Модальное окно пользователя
│   ├── ModalWorkouts/            # Модальное окно тренировок
│   ├── Navigation/               # Навигация
│   └── PromoBanner/              # Промо-баннер
├── context/                      # React Context
│   └── ModalContext.tsx          # Контекст для управления модальными окнами
├── hooks/                        # Кастомные React хуки
│   ├── useAuth.ts                # Хук для работы с авторизацией
│   └── useCourse.ts              # Хук для работы с курсами
├── lib/                          # Утилиты и типы
│   ├── api.ts                    # Axios клиент и API методы
│   ├── types.ts                  # TypeScript типы и Zod схемы
│   └── utils.ts                  # Утилитарные функции
├── libs/                         # Сервисные функции
│   └── fitness.ts                # Функции для работы с фитнес-API
├── store/                        # Redux store
│   ├── features/
│   │   ├── authSlice.ts          # Слайс для авторизации
│   │   └── courseSlise.ts        # Слайс для курсов
│   ├── hooks.ts                  # Типизированные Redux хуки
│   ├── ReduxProvider.tsx         # Провайдер Redux
│   └── store.ts                  # Конфигурация store
└── public/
    └── img/                      # Статические изображения
```

## Основной функционал

### 1. Авторизация и регистрация
- **Регистрация**: Пользователь может создать аккаунт, указав email и пароль
  - Валидация пароля: минимум 6 символов, минимум 2 спецсимвола, минимум одна заглавная буква
  - Проверка совпадения паролей
- **Авторизация**: Вход по email и паролю
- **Хранение токена**: JWT токен сохраняется в localStorage
- **Автоматическая авторизация**: При наличии токена пользователь автоматически авторизуется

### 2. Главная страница
- **Отображение всех курсов**: Список доступных курсов загружается с API
- **Карточки курсов**: Каждая карточка содержит:
  - Изображение курса
  - Название (на русском языке)
  - Длительность курса (в днях)
  - Ежедневное время тренировок
  - Сложность курса
  - Кнопка добавления курса (для авторизованных пользователей)
- **Промо-баннер**: Баннер с призывом "Измени своё тело за полгода!"
- **Кнопка "Наверх"**: Плавная прокрутка к началу страницы
- **Защита от множественных запросов**: Использование useRef для предотвращения race conditions

### 3. Страница курса
- **Описание курса**: 
  - Большое изображение курса
  - Блок "Подойдет для вас, если:" с пронумерованными пунктами
  - Блок "Направления" с характеристиками курса
  - Декоративные элементы (изображения)
- **Действия**:
  - Для неавторизованных: кнопка "Войдите, чтобы добавить курс"
  - Для авторизованных без курса: кнопка "Добавить курс"
  - Для авторизованных с курсом: кнопки "Начать тренировку" и "Удалить курс"
- **Модальное окно тренировок**: Открывается список тренировок курса

### 4. Страница тренировки
- **Видео YouTube**: Воспроизведение видео-материала тренировки
- **Список упражнений**: Отображение всех упражнений тренировки с прогрессом
- **Прогресс выполнения**: Процент выполнения каждого упражнения
- **Модальное окно прогресса**: Возможность ввести свой прогресс по каждому упражнению
- **Сохранение прогресса**: Прогресс сохраняется через API

### 5. Страница профиля пользователя
- **Информация о пользователе**: Отображение email пользователя
- **Список добавленных курсов**: Все курсы, добавленные пользователем
- **Управление курсами**: Возможность удалить курс
- **Сброс прогресса**: Возможность сбросить прогресс по курсу
- **Выход**: Кнопка выхода из аккаунта

### 6. Модальные окна
- **ModalLogin**: Модальное окно для авторизации/регистрации
- **ModalUser**: Модальное окно с информацией о пользователе и выходом
- **ModalWorkouts**: Модальное окно со списком тренировок курса
- **ModalProgress**: Модальное окно для ввода прогресса тренировки

## Интеграция с API

### Внешнее API
Приложение интегрировано с внешним REST API: `https://wedev-api.sky.pro/api/fitness`

### Прокси-роуты (Next.js API Routes)
Для обхода CORS и централизованной обработки запросов созданы прокси-роуты в `/app/api/fitness/[...path]/route.ts`, которые:
- Перенаправляют запросы на внешнее API
- Передают заголовок Authorization (JWT токен)
- НЕ добавляют Content-Type (по требованию API)
- Обрабатывают ошибки и возвращают понятные сообщения

### Основные эндпоинты

#### Авторизация
- `POST /api/fitness/auth/register` — регистрация пользователя
- `POST /api/fitness/auth/login` — авторизация пользователя

#### Пользователи
- `GET /api/fitness/users/me` — получение данных текущего пользователя
- `POST /api/fitness/users/me/courses` — добавление курса пользователю
- `DELETE /api/fitness/users/me/courses/:courseId` — удаление курса у пользователя

#### Курсы
- `GET /api/fitness/courses` — получение всех курсов
- `GET /api/fitness/courses/:courseId` — получение курса по ID
- `GET /api/fitness/courses/:courseId/workouts` — получение тренировок курса
- `PATCH /api/fitness/courses/:courseId/reset` — сброс прогресса курса

#### Тренировки
- `GET /api/fitness/workouts/:workoutId` — получение тренировки по ID
- `PATCH /api/fitness/courses/:courseId/workouts/:workoutId` — сохранение прогресса тренировки

#### Прогресс
- `GET /api/fitness/users/me/progress?courseId=:courseId` — прогресс по курсу
- `GET /api/fitness/users/me/progress?courseId=:courseId&workoutId=:workoutId` — прогресс по тренировке

## Управление состоянием

### Redux Store
Приложение использует Redux Toolkit для управления глобальным состоянием:

#### Auth Slice (`authSlice.ts`)
- `user`: email пользователя (string)
- `token`: JWT токен
- `isAuth`: статус авторизации
- `loading`: состояние загрузки
- `error`: сообщения об ошибках
- Асинхронные thunks: `login`, `register`

#### Course Slice (`courseSlise.ts`)
- `allCourses`: все курсы
- `selectedCourses`: ID выбранных пользователем курсов
- `loading`: состояние загрузки
- `error`: сообщения об ошибках

### React Context
- **ModalContext**: Управление видимостью модального окна авторизации

### Локальное состояние
- Использование `useState` для локального состояния компонентов
- Использование `useRef` для предотвращения race conditions

## Типизация и валидация

### TypeScript типы
Все данные строго типизированы:
- `User` — пользователь
- `Course` — курс
- `Workout` — тренировка
- `Exercise` — упражнение
- `CourseProgress` — прогресс по курсу
- `WorkoutProgress` — прогресс по тренировке

### Zod схемы
Валидация форм выполняется с помощью Zod:
- `loginSchema` — схема валидации формы входа
- `registerSchema` — схема валидации формы регистрации (включая проверку совпадения паролей)

## Особенности реализации

### Обработка ошибок
- Централизованная функция `getErrorMessage` для обработки ошибок API
- Приоритет сообщений от сервера над стандартными HTTP ошибками
- Отображение ошибок пользователю в понятном формате

### Оптимизация производительности
- Использование `useCallback` для мемоизации функций
- Использование `useRef` для предотвращения множественных запросов
- Ленивая загрузка изображений (`loading="lazy"`)
- Приоритетная загрузка критических изображений (`priority`)

### Адаптивность
- Responsive дизайн с использованием CSS Modules и Tailwind CSS
- Медиа-запросы для мобильных устройств (max-width: 495px)
- Адаптивные сетки и флексбокс-разметки

### Безопасность
- JWT токен хранится в localStorage
- Токен автоматически добавляется в заголовки запросов через Axios interceptor
- Валидация данных на клиенте перед отправкой на сервер

### SSR и CSR
- Использование `'use client'` для клиентских компонентов
- Проверки `typeof window !== 'undefined'` для SSR безопасности
- Server Components для статических страниц

## Стилизация

### CSS Modules
Каждый компонент имеет свой CSS модуль:
- Изолированные стили
- Локальные имена классов
- TypeScript поддержка

### Tailwind CSS
Используется для utility-классов:
- Быстрая разработка
- Responsive утилиты
- Кастомные цвета (primary, secondary)

### Дизайн-система
- Основной цвет: `#BCEC30` (лайм-зеленый)
- Шрифт: Roboto
- Скругления: 30px для карточек, кнопок
- Тени: мягкие тени для глубины

## Запуск проекта

### Установка зависимостей
```bash
pnpm install
```

### Настройка переменных окружения
Создайте файл `.env.local`:
```
NEXT_PUBLIC_API_URL=https://wedev-api.sky.pro/api/fitness
```

### Разработка
```bash
pnpm dev
```
Приложение будет доступно на `http://localhost:3000`

### Сборка
```bash
pnpm build
pnpm start
```

### Линтинг
```bash
pnpm lint
```

### Форматирование
```bash
pnpm format
```

## Критерии качества кода

- ✅ Строгая типизация TypeScript (без `any`)
- ✅ Отсутствие закомментированного кода
- ✅ Отсутствие `console.log` в продакшн-коде
- ✅ Логичная структура компонентов (отдельная папка для каждого)
- ✅ Чистая консоль (без ошибок и предупреждений)
- ✅ Правильная обработка ошибок API
- ✅ Валидация форм согласно требованиям API

## Структура компонентов

Компоненты организованы по принципу:
- Одна папка = один компонент
- Каждый компонент имеет свой CSS модуль
- Переиспользуемые компоненты вынесены в отдельные папки
- Логические группы компонентов объединены (модальные окна, формы)

## Будущие улучшения

Потенциальные направления развития:
- Тестирование (unit, integration, e2e)
- PWA функциональность
- Офлайн-режим
- Push-уведомления
- Социальные функции (комментарии, рейтинги)
- Расширенная аналитика прогресса
- Интеграция с календарем

---

**Версия**: 0.1.0  
**Последнее обновление**: 2024
